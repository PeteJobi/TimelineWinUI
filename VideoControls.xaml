<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Timeline.VideoControls"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:CommunityToolkit.WinUI.Converters"
    xmlns:timeline="using:Timeline"
    mc:Ignorable="d">

    <UserControl.Resources>
        <converters:BoolToObjectConverter x:Key="PlayPauseTipConverter" TrueValue="Play" FalseValue="Pause"/>
        <converters:BoolToObjectConverter x:Key="PlayPauseGlyphConverter" TrueValue="&#xF8AE;" FalseValue="&#xF5B0;"/>
        <converters:BoolToObjectConverter x:Key="MuteUnmuteTipConverter" TrueValue="Mute" FalseValue="Unmute"/>
        <converters:BoolToObjectConverter x:Key="MuteUnmuteGlyphConverter" TrueValue="&#xE74F;" FalseValue="&#xE767;"/>
        <converters:BoolToObjectConverter x:Key="ProgressTextWidthConverter" TrueValue="90" FalseValue="60"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:BoolNegationConverter x:Key="BoolNegationConverter"/>
        <converters:EmptyObjectToObjectConverter x:Key="NullToVisibilityConverter" EmptyValue="Collapsed" NotEmptyValue="Visible"/>
    </UserControl.Resources>

    <Grid ColumnSpacing="{x:Bind Spacing, Mode=OneWay}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>
        <StackPanel Orientation="Horizontal" Spacing="{x:Bind Spacing, Mode=OneWay}">
            <ContentPresenter Content="{x:Bind BeforePlay, Mode=OneWay}"
                              Visibility="{x:Bind BeforePlay, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}"/>
            <Button Click="PlayPause" VerticalAlignment="Center"
                    ToolTipService.ToolTip="{x:Bind viewModel.IsPlaying, Mode=OneWay, Converter={StaticResource PlayPauseTipConverter}}">
                <FontIcon Glyph="{x:Bind viewModel.IsPlaying, Mode=OneWay, Converter={StaticResource PlayPauseGlyphConverter}}"/>
            </Button>
            <ContentPresenter Content="{x:Bind BetweenPlayAndProgress, Mode=OneWay}"
                              Visibility="{x:Bind BetweenPlayAndProgress, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}"/>
        </StackPanel>
        <Slider Grid.Column="1" Name="VideoProgressSlider" VerticalAlignment="Center" ValueChanged="VideoProgressSlider_OnValueChanged" StepFrequency="0.25"/>
        <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="{x:Bind Spacing, Mode=OneWay}">
            <ContentPresenter Content="{x:Bind BetweenProgressAndTime, Mode=OneWay}"
                              Visibility="{x:Bind BetweenProgressAndTime, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}"/>
            <StackPanel Orientation="Horizontal"
                        Visibility="{x:Bind HideTimes, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}">
                <Grid Width="{x:Bind ShowFractionalSeconds, Mode=OneWay, Converter={StaticResource ProgressTextWidthConverter}}"
                      Visibility="{x:Bind CurrentTimeEditable, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}">
                    <TextBlock Name="ProgressText" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                </Grid>
                <timeline:TimeSpanTextBox x:Name="ProgressValue" VerticalAlignment="Center" Visibility="{x:Bind CurrentTimeEditable, Mode=OneWay}"
                                          ValueChanged="ProgressValue_OnValueChanged"
                                          DontShowFractionalSeconds="{x:Bind ShowFractionalSeconds, Mode=OneWay, Converter={StaticResource BoolNegationConverter}}"/>
                <TextBlock Name="DurationText" VerticalAlignment="Center"/>
            </StackPanel>
            <ContentPresenter Content="{x:Bind BetweenTimeAndMute, Mode=OneWay}"
                              Visibility="{x:Bind BetweenTimeAndMute, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}"/>
            <Button Click="MuteUnmute" VerticalAlignment="Center"
                    Visibility="{x:Bind HideMute, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=True}"
                    ToolTipService.ToolTip="{x:Bind viewModel.IsMuted, Mode=OneWay, Converter={StaticResource MuteUnmuteTipConverter}}">
                <FontIcon Glyph="{x:Bind viewModel.IsMuted, Mode=OneWay, Converter={StaticResource MuteUnmuteGlyphConverter}}"/>
            </Button>
            <ContentPresenter Content="{x:Bind AfterMute, Mode=OneWay}" Visibility="{x:Bind AfterMute, Converter={StaticResource NullToVisibilityConverter}}"/>
        </StackPanel>
    </Grid>

</UserControl>
